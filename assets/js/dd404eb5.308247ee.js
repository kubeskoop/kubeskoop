"use strict";(self.webpackChunkkubeskoop_io=self.webpackChunkkubeskoop_io||[]).push([[3325],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(a),f=o,m=d["".concat(l,".").concat(f)]||d[f]||c[f]||r;return a?n.createElement(m,i(i({ref:t},p),{},{components:a})):n.createElement(m,i({ref:t},p))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=f;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<r;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}f.displayName="MDXCreateElement"},8448:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var n=a(7462),o=(a(7294),a(3905));const r={sidebar_position:3},i="Visualization",s={unversionedId:"guide/monitoring/visualization",id:"guide/monitoring/visualization",title:"Visualization",description:"Using Prometheus & Grafana for visualization of metrics",source:"@site/docs/guide/monitoring/visualization.md",sourceDirName:"guide/monitoring",slug:"/guide/monitoring/visualization",permalink:"/docs/guide/monitoring/visualization",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Intro",permalink:"/docs/guide/monitoring/intro"},next:{title:"Network Graph",permalink:"/docs/guide/network-graph"}},l={},u=[{value:"Using Prometheus &amp; Grafana for visualization of metrics",id:"using-prometheus--grafana-for-visualization-of-metrics",level:2},{value:"Configuring KubeSkoop metrics",id:"configuring-kubeskoop-metrics",level:3},{value:"Import the pre-defined default dashboard",id:"import-the-pre-defined-default-dashboard",level:3},{value:"Use Grafana &amp; Loki to view visualized network events",id:"use-grafana--loki-to-view-visualized-network-events",level:2},{value:"Installation",id:"installation",level:3},{value:"Configure KubeSkoop event stream",id:"configure-kubeskoop-event-stream",level:3},{value:"Grafana dashboard",id:"grafana-dashboard",level:4}],p={toc:u},d="wrapper";function c(e){let{components:t,...r}=e;return(0,o.kt)(d,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"visualization"},"Visualization"),(0,o.kt)("h2",{id:"using-prometheus--grafana-for-visualization-of-metrics"},"Using Prometheus & Grafana for visualization of metrics"),(0,o.kt)("p",null,"KubeSkoop provides a standard Prometheus format metric output service. You can quickly integrate KubeSkoop's metrics into an existing monitoring system. Please refer to the ",(0,o.kt)("strong",{parentName:"p"},"configuration")," for details."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"If there is no ready-to-use monitoring service, please refer to the ",(0,o.kt)("strong",{parentName:"p"},"installation")," guide to set up a visual monitoring service."),(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"Refer to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://prometheus.io/docs/prometheus/latest/installation/"},"Prometheus Installation"))," to complete the deployment and installation of Prometheus."),(0,o.kt)("li",{parentName:"ul"},"Refer to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://prometheus.io/docs/visualization/grafana/"},"Grafana Installation"))," to complete the deployment and installation of Grafana."))),(0,o.kt)("h3",{id:"configuring-kubeskoop-metrics"},"Configuring KubeSkoop metrics"),(0,o.kt)("p",null,"KubeSkoop supports the service discovering of Prometheus running in Kubernetes. After installing Prometheus, you can view the ready instances by entering ",(0,o.kt)("strong",{parentName:"p"},"skoop-exporter")," in the search bar on the ",(0,o.kt)("strong",{parentName:"p"},"Status->Targets")," page, for example:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"prometheus-exporter-targets",src:a(1295).Z,width:"1269",height:"836"})),(0,o.kt)("p",null,"After the KubeSkoop instance is successfully scraped by Prometheus, you can complete the visualization of metrics through the following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Enter the Grafana console, click ",(0,o.kt)("strong",{parentName:"li"},"Configuration->Data sources->Add data source"),", select Prometheus, and add the address of the prepared Prometheus instance to the data source subscription of Grafana\n",(0,o.kt)("img",{alt:"grafana-prometheus-datasource",src:a(7259).Z,width:"1269",height:"1182"})),(0,o.kt)("li",{parentName:"ol"},"Create a new dashboard or select to create a new panel in an existing dashboard. In the panel configuration, select the data source configured in ",(0,o.kt)("strong",{parentName:"li"},"1"),", enter inspector in the Metric browser, and you can see the associated KubeSkoop metrics. Select the desired information from it, for example, ",(0,o.kt)("strong",{parentName:"li"},"inspector_pod_netdevrxbytes"),". After inputting this, you can see the obtained data in the panel.\n",(0,o.kt)("img",{alt:"grafana-prometheus-panel",src:a(6527).Z,width:"1281",height:"1244"})),(0,o.kt)("li",{parentName:"ol"},"In the visualization of metrics, you can set the legend and unit information of the metrics as needed. The legend supports configuring information such as the Pod's namespace, IP, and label. These supported legends can be configured in the panel's ",(0,o.kt)("strong",{parentName:"li"},"Legend"),".")),(0,o.kt)("h3",{id:"import-the-pre-defined-default-dashboard"},"Import the pre-defined default dashboard"),(0,o.kt)("p",null,"KubeSkoop provides a default Grafana dashboard configuration file that can follow version updates:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl https://raw.githubusercontent.com/alibaba/kubeskoop/main/deploy/resource/kubeskoop-exporter-dashboard.json -o dashboard.json\n")),(0,o.kt)("p",null,"After logging in to the Grafana console, click ",(0,o.kt)("strong",{parentName:"p"},"Dashboards->Import->Upload JSON")," file, select the saved file for upload, select ",(0,o.kt)("strong",{parentName:"p"},"Take Prometheus as data source"),", and click ",(0,o.kt)("strong",{parentName:"p"},"Import")," to import it. You can then view the default dashboard. By selecting different panel groups, you can view monitoring metrics of different categories."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"default_dashboard",src:a(5e3).Z,width:"1275",height:"1181"})),(0,o.kt)("h2",{id:"use-grafana--loki-to-view-visualized-network-events"},"Use Grafana & Loki to view visualized network events"),(0,o.kt)("h3",{id:"installation"},"Installation"),(0,o.kt)("p",null,"Follow the official documentation to install Grafana Loki for different scenarios ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://grafana.com/docs/loki/latest/installation/helm/"},"Grafana Loki Installation")),"\u3002"),(0,o.kt)("p",null,"After installation, you can check the availability of Grafana Loki using the following methods:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl http://[Endpoint of Grafana Loki]:3100/ready\n")),(0,o.kt)("h3",{id:"configure-kubeskoop-event-stream"},"Configure KubeSkoop event stream"),(0,o.kt)("h4",{id:"grafana-dashboard"},"Grafana dashboard"),(0,o.kt)("p",null,"You can use Grafana to visualize the events which KubeSkoop pushed to Grafana Loki. Follow these steps to achieve visualization:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"After clicking ",(0,o.kt)("strong",{parentName:"li"},"Configuration->Data sources->Add data source"),", select Loki, and add the address of the Grafana Loki service to the data source subscription of Grafana. This can be an IP address or domain name with a default port of 3100.\n",(0,o.kt)("img",{alt:"grafana-loki-datasource",src:a(3956).Z,width:"1270",height:"1223"})),(0,o.kt)("li",{parentName:"ol"},"Create a new dashboard or select a new panel in an existing dashboard. In the panel configuration, select the data source configured in ",(0,o.kt)("strong",{parentName:"li"},"step 1")," as the data source, and filter the required event information in the ",(0,o.kt)("strong",{parentName:"li"},"Label browser"),".\n",(0,o.kt)("img",{alt:"grafana-loki-panel",src:a(6137).Z,width:"859",height:"899"})),(0,o.kt)("li",{parentName:"ol"},"In the event panel, you can query specific events through ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://grafana.com/docs/loki/latest/logql/log_queries/"},"LogQL")),". After clicking on the event, you can view detailed on-site information.\n",(0,o.kt)("img",{alt:"grafana-loki-detail",src:a(9811).Z,width:"1012",height:"1009"}))))}c.isMDXComponent=!0},3956:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/datasource-loki-15ee1bf52f701c1e17eae58dda297d40.jpg"},7259:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/datasource-prometheus-f3d9875bad0bdfcf63b533a62591d8eb.jpg"},5e3:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/default_dashboard-52cf17f9222bade190e27a769970354f.jpg"},9811:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/loki-event-detail-5cd41c06985612116234b0b207611e80.jpg"},6137:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/panel-loki-fd73f796f4db003ba6c2d6963202528f.jpg"},6527:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/panel-prometheus-856a086cf7d6a38a822a0fb49a8997cc.jpg"},1295:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/prometheus-targets-a0f41670fb6cc7ea15ecf62cad1ea5a5.jpg"}}]);