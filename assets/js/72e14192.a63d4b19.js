"use strict";(self.webpackChunkkubeskoop_io=self.webpackChunkkubeskoop_io||[]).push([[7239],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,m=u["".concat(l,".").concat(d)]||u[d]||k[d]||a;return n?o.createElement(m,i(i({ref:t},c),{},{components:n})):o.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4181:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>k,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var o=n(7462),r=(n(7294),n(3905));const a={sidebar_position:2},i="Quick Start",s={unversionedId:"quick-start",id:"quick-start",title:"Quick Start",description:"How to diagnose your kubernetes cluster by KubeSkoop?",source:"@site/docs/quick-start.md",sourceDirName:".",slug:"/quick-start",permalink:"/docs/quick-start",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Intro",permalink:"/docs/intro"},next:{title:"Guide",permalink:"/docs/category/guide"}},l={},p=[{value:"Kind of kubernetes network issues:",id:"kind-of-kubernetes-network-issues",level:2},{value:"One-Shot diagnose persistent network failure",id:"one-shot-diagnose-persistent-network-failure",level:2},{value:"Install KubeSkoop command",id:"install-kubeskoop-command",level:3},{value:"One-Shot Diagnose",id:"one-shot-diagnose",level:3},{value:"Monitor network jitter and bottlenecks",id:"monitor-network-jitter-and-bottlenecks",level:2},{value:"Install monitor components",id:"install-monitor-components",level:3},{value:"network performance analysis",id:"network-performance-analysis",level:3},{value:"network jitter &amp; anomy event analysis",id:"network-jitter--anomy-event-analysis",level:3}],c={toc:p},u="wrapper";function k(e){let{components:t,...a}=e;return(0,r.kt)(u,(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"quick-start"},"Quick Start"),(0,r.kt)("p",null,"How to diagnose your kubernetes cluster by KubeSkoop?"),(0,r.kt)("h2",{id:"kind-of-kubernetes-network-issues"},"Kind of kubernetes network issues:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Persistent network failure",(0,r.kt)("br",{parentName:"p"}),"\n","Most of persistent network failure issue are misconfig of network stack, e.g. error iptables rule, misconfig of VM security group.",(0,r.kt)("br",{parentName:"p"}),"\n","KubeSkoop generates a traffic graph by analyzing the link of ",(0,r.kt)("inlineCode",{parentName:"p"},"src->dst"),", and then performs rule verification and simulation on the nodes and edges on the graph to locate the network misconfiguration.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Occasional network jitter\nOccasional packet delays, losses, and retransmissions in network links often lead to application jitter problems. Because they are sporadic, it is difficult to trace back and locate the root cause of the problem.",(0,r.kt)("br",{parentName:"p"}),"\n","KubeSkoop monitors the key path of the protocol stack in the kernel through eBPF in-depth, integrates multiple indicators to correlate typical jitter scenarios, and records and traces back to the root cause of network anomalies.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Network performance bottlenecks",(0,r.kt)("br",{parentName:"p"}),"\n","Application network dependencies are usually associated with many network links, such as upstream and downstream services, DNS resolution, etc., and it is difficult to analyze the root cause when the performance cannot improve.",(0,r.kt)("br",{parentName:"p"}),"\n","KubeSkoop finds out key links that affect performance by analyzing application-related links and application-layer bottlenecks."))),(0,r.kt)("h2",{id:"one-shot-diagnose-persistent-network-failure"},"One-Shot diagnose persistent network failure"),(0,r.kt)("h3",{id:"install-kubeskoop-command"},"Install KubeSkoop command"),(0,r.kt)("p",null,"Through ",(0,r.kt)("inlineCode",{parentName:"p"},"go install")," to install KubeSkoop cli\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"go install github.com/alibaba/kubeskoop/cmd/skoop@main\n")),(0,r.kt)("h3",{id:"one-shot-diagnose"},"One-Shot Diagnose"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ skoop -s 172.18.0.4 -d 10.96.0.10 -p 53 --http # Execute the diagnostic command, specify the src,dst, and use --http to provide the diagnostic result through the local web service\nI0118 11:43:23.383446    6280 web.go:97] HTTP server listening on http://127.0.0.1:8080 # After the diagnosis is completed, a link to the diagnosis result will be output\n")),(0,r.kt)("p",null,"Open the diagnosis result ",(0,r.kt)("inlineCode",{parentName:"p"},"http://127.0.0.1:8080")," through browser\uff1a\n",(0,r.kt)("img",{alt:"diagnose_web",src:n(7530).Z,width:"1509",height:"888"})),(0,r.kt)("h2",{id:"monitor-network-jitter-and-bottlenecks"},"Monitor network jitter and bottlenecks"),(0,r.kt)("h3",{id:"install-monitor-components"},"Install monitor components"),(0,r.kt)("p",null,"The Skoop exporter bundles with Prometheus, Grafana, and Loki\ncan be quickly deployed in a Kubernetes cluster by following these steps:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f https://raw.githubusercontent.com/alibaba/kubeskoop/main/deploy/skoopbundle.yaml\n")),(0,r.kt)("p",null,"Confirm that the installation is complete and obtain access through the following steps\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# View the status of Skoop exporter\nkubectl get pod -n kubeskoop -l app=kubeskoop-exporter -o wide\n# View the status of Probe collection probes\nkubectl get --raw /api/v1/namespaces/kubeskoop/pods/skoop-exporter-t4d9m:9102/proxy/status |jq .\n# Obtain the entrance of Prometheus service, which is exposed by NodePort by default\nkubectl get service -n kubeskoop prometheus-service -o wide\n# Obtain the access entry of the Grafana console, which is exposed by NodePort by default\nkubectl get service -n kubeskoop grafana -o wide\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Note: skoopbundle.yaml starts with a minimal copy, not suitable for production environments"))),(0,r.kt)("h3",{id:"network-performance-analysis"},"network performance analysis"),(0,r.kt)("p",null,"Open the NodePort Service of grafana on web browser, open the network monitoring page,\nand check the water level of each monitor item corresponding to the time point of the performance problem. For example\uff1a",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("img",{alt:"grafana_performance",src:n(3717).Z,width:"1212",height:"1037"}),(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u5177\u4f53\u6307\u6807\u8bf4\u660e\u53c2\u8003\u6587\u6863: ",(0,r.kt)("a",{parentName:"em",href:"/docs/guide/exporter/exporter-description"},"Kubeskoop exporter \u529f\u80fd\u7b80\u4ecb")," "))),(0,r.kt)("h3",{id:"network-jitter--anomy-event-analysis"},"network jitter & anomy event analysis"),(0,r.kt)("p",null,"Open the NodePort Service of grafana on web browser, open the Loki page,\ncheck the events corresponding to the time point of network jitter and the water level corresponding to the network monitoring page.\n",(0,r.kt)("img",{alt:"grafana_performance",src:n(8168).Z,width:"1266",height:"729"}),(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u5177\u4f53\u6307\u6807\u8bf4\u660e\u53c2\u8003\u6587\u6863: ",(0,r.kt)("a",{parentName:"em",href:"/docs/guide/exporter/exporter-description"},"Kubeskoop exporter \u529f\u80fd\u7b80\u4ecb")," "))))}k.isMDXComponent=!0},3717:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/dashboard-689bbedaa5dc5bd531c0e699ecef00e8.png"},7530:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/intro_diagnose_web-5cc33839caa1aeb8aa1b88f317a73e75.jpg"},8168:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/loki_tracing-0d88496ce9a71ca07a4fd649e615b0e2.png"}}]);